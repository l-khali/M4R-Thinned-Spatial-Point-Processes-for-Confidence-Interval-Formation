lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=1.5,col=green)
legend(0.7, 0.039, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
par(mfrow = c(1, 2))
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=1.5,col=green)
legend(0.7, 0.039, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
par(mfrow = c(1, 2))
plot(thinning_params, thinned_sigmas_exp,type="l",col=2,xlab="p", main="Variance of Intensity Estimates on \n Poisson Probability Distribution")
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=3)
par(mfrow = c(1, 2))
plot(thinning_params, thinned_sigmas_exp,type="l",col=2, main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",cex.main=2,lwd=1.5,col=purple)
par(mfrow = c(1, 2))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",cex.main=2,lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=1.5,xlab="",ylab="")
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=1.5,col=green)
legend(0.7, 0.039, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=1.5,col=purple)
par(mfrow = c(1, 2))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=1.5,xlab="",ylab="")
legend(0.7, 0.039, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
legend(0.1, 0.039, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
par(mfrow = c(1, 2))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=1.5,xlab="",ylab="")
par(mfrow = c(1, 2))
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=1.5,col=green)
legend(0.1, 0.039, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
par(mfrow = c(1, 2))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=1.5,xlab="",ylab="")
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=1.5,col=green)
legend(0.1, 0.039, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
par(mfrow = c(1, 2))
legend(0.6, 0.0025, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
par(mfrow = c(1, 2))
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.6, 0.0025, c(TeX(r'($\hat{\sigma}/p^2$)'), TeX(r'($\hat{sigma}_s$)')), col = c(3, 2), lty = c(1, 1),
merge = TRUE)
legend(0.6, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lty = c(2, 2),
merge = TRUE)
par(mfrow = c(1, 2))
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.6, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
# theoretic variance from lagache + lang paper (works well!)
area <- W^2
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=1.5,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=1.5,xlab="",ylab="")
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
par(mfrow = c(1, 2))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=2,xlab="",ylab="")
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
par(mfrow = c(1, 2))
# lagache scaling
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
par(mfrow = c(1, 3))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=2,xlab="",ylab="")
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
# lagache scaling
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process (Lagache)"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex.legend=1.3)
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.3)
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=2)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.2)
par(mfrow = c(1, 3))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=2,xlab="",ylab="")
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.2)
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.2)
# lagache scaling
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process (Lagache)"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.2)
par(mfrow = c(1, 3))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=2,xlab="",ylab="")
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.5)
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.5)
# lagache scaling
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process (Lagache)"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.5)
par(mfrow = c(1, 3))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=2,xlab="",ylab="")
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.5)
# plot(thinning_params, thinned_sigmas,type="l",col=2,xlab="p",ylab=TeX("Thinned Variance, ${sigma}_s$"), main="Homogenous Poisson")
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.5)
# lagache scaling
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=1.5)
par(mfrow = c(1, 3))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=2,xlab="",ylab="")
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=0.8)
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=0.8)
# lagache scaling
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE,cex=0.8)
par(mfrow = c(1, 3))
plot(thinning_params, thinned_sigmas_exp,type="l", main="Variance of Intensity Estimates on \n Poisson Probability Distribution",ylab="",xlab="",font.main=2,lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2*((1-thinning_params)/thinning_params),col=green,lwd=2,xlab="",ylab="")
legend(0.55, 85, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
# hopefully the lines are very close
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial*(1-thinning_params)/thinning_params, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}(1-p)/p$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
# lagache scaling
plot(thinning_params, thinned_sigmas,type="l",xlab=" ",ylab=" ",font.main=2,main=("Variance of Ripley's K Estimates on \n Poisson Point Process"),lwd=2,col=purple)
title(mgp=c(2.5,0,0),xlab=TeX("Thinning parameter, $p$"),ylab=TeX(r'(Sample Variance, $\hat{\sigma}$)'))
lines(thinning_params, sigma2_spatial/thinning_params^2, lwd=2,col=green)
legend(0.55, 0.0025, c(TeX(r'($\hat{\sigma}_s$)'), TeX(r'($\hat{sigma}/p^2$)')), col = c(purple, green), lwd = c(2, 2),
merge = TRUE)
poisson_simulation_thinning_sv_p_squared <- function(nsim, lambda, thinning_param, alpha, R = 499, inhomogenous = FALSE, intensity_est = FALSE) {
r <- seq(0.0, 0.14, 0.01)
if (inhomogenous) {
K_actual <- K_actual_inhom()
} else {
K_actual <- rep(c(pi),each=15) * r * r
}
cover <- rep(c(0),each=15)
coverage <- cbind(r, cover)
# scaler <- scaling_constant_inhom(thinning_param,intensity=intensity2, mean=TRUE)
scaler <- thinning_param^2
for (i in 1:nsim) {
tryCatch({print(paste0("Current simulation:",i))
if (inhomogenous) {
data <- rpoispp(intensity2)
}else {
data <- rpoispp(lambda)
}
confidences <- thinning_sample_var(data, thinning_param, alpha, R = R, inhomogenous = inhomogenous, scaler = scaler, intensity_est = intensity_est)
for (j in 1:length(r)) {
if (confidences[j,1] <= K_actual[j] & K_actual[j] <= confidences[j,2]) {
coverage[j,2] = coverage[j,2] + 1/nsim
}
}}, warning = function(w) { print("A simulation didn't work! Maybe a block is empty?") })
}
return(coverage)
}
thinning_sv_08_2 <- poisson_simulation_thinning_sv_p_squared(1000, 250, 0.8, 0.05)
thinning_sample_var <- function(data, thinning_param, alpha, R=99, inhomogenous=FALSE, scaler = 1, intensity_est = FALSE) {
# confidence intervals calculated using sample variance
process_df <- as.data.frame(data)
npoints <- nrow(process_df)
r <- seq(0.0, 0.14, 0.01)
k_vals <- data.frame(r)
for (i in 1:R) {
unif <- runif(npoints, 0, 1)
subprocess_df <- process_df[which(unif < thinning_param),]
subprocess <- as.ppp(subprocess_df, owin(c(0,1),c(0,1)))
if (inhomogenous) {
if (intensity_est) {
k <- Kinhom(subprocess, r=r, correction=c("isotropic"))
} else {
k <- Kinhom(subprocess, lambda=intensity2, r=r, correction=c("isotropic"))
}
} else {
k <- Kest(subprocess, r=r, correction=c("isotropic"))
}
k_vals <- cbind(k_vals, as.data.frame(k)["iso"])
}
# scaler <- scaling_constant_inhom(thinning_param, 250, mean=TRUE)
if (inhomogenous) {
K_est <- as.data.frame(Kinhom(data, lambda=intensity2, r=r, correction=c("isotropic")))["iso"]
} else {
K_est <- as.data.frame(Kest(data, r=r, correction=c("isotropic")))["iso"]
}
t <- qt((1-alpha/2), df = R - 1)
lower_approx <- c()
upper_approx <- c()
for (radius in 1:15) {
sample_variance <- var(as.numeric(k_vals[radius,-1]))
lower_approx <- c(lower_approx, K_est[radius,] - t * sqrt(sample_variance/scaler))
upper_approx <- c(upper_approx, K_est[radius,] + t * sqrt(sample_variance/scaler))
}
return(cbind(lower_approx, upper_approx))
}
poisson_simulation_thinning_sv_p_squared <- function(nsim, lambda, thinning_param, alpha, R = 499, inhomogenous = FALSE, intensity_est = FALSE) {
r <- seq(0.0, 0.14, 0.01)
if (inhomogenous) {
K_actual <- K_actual_inhom()
} else {
K_actual <- rep(c(pi),each=15) * r * r
}
cover <- rep(c(0),each=15)
coverage <- cbind(r, cover)
# scaler <- scaling_constant_inhom(thinning_param,intensity=intensity2, mean=TRUE)
scaler <- 1/thinning_param^2
for (i in 1:nsim) {
tryCatch({print(paste0("Current simulation:",i))
if (inhomogenous) {
data <- rpoispp(intensity2)
}else {
data <- rpoispp(lambda)
}
confidences <- thinning_sample_var(data, thinning_param, alpha, R = R, inhomogenous = inhomogenous, scaler = scaler, intensity_est = intensity_est)
for (j in 1:length(r)) {
if (confidences[j,1] <= K_actual[j] & K_actual[j] <= confidences[j,2]) {
coverage[j,2] = coverage[j,2] + 1/nsim
}
}}, warning = function(w) { print("A simulation didn't work! Maybe a block is empty?") })
}
return(coverage)
}
thinning_sv_08_2 <- poisson_simulation_thinning_sv_p_squared(100, 250, 0.8, 0.05)
thinning_sv_08_2
thinning_sv_08_2 <- poisson_simulation_thinning_sv_p_squared(1000, 250, 0.8, 0.05)
thinning_sv_05_2 <- poisson_simulation_thinning_sv_p_squared(1000, 250, 0.5, 0.05)
thinning_sv_02_2 <- poisson_simulation_thinning_sv_p_squared(1000, 250, 0.2, 0.05)
sc_simulation_thinning_sv_p_squared <- function(nsim, lambda, thinning_param, alpha, R=99) {
r <- seq(0.0, 0.14, 0.01)
K_actual <- soft_core_actual_k()
cover <- rep(c(0),each=15)
coverage <- cbind(r, cover)
scaler <- 1/thinning_param^2
for (i in 1:nsim) {
print(paste0("Current simulation:",i))
# generating softcore process
data <- simulate_soft_core()
confidences <- thinning_sample_var(data, thinning_param, alpha, R=99, scaler = scaler)
for (j in 1:length(r)) {
if (confidences[j,1] <= K_actual[j] & K_actual[j] <= confidences[j,2]) {
coverage[j,2] <- coverage[j,2] + 1/nsim
}
}
}
return(coverage)
}
thinning_sv_08_2
thinning_sv_05_2
thinning_sv_02_2
sc_simulation_thinning_sv_p_squared <- function(nsim, lambda, thinning_param, alpha, R=99) {
r <- seq(0.0, 0.14, 0.01)
K_actual <- soft_core_actual_k()
cover <- rep(c(0),each=15)
coverage <- cbind(r, cover)
scaler <- 1/thinning_param^2
for (i in 1:nsim) {
print(paste0("Current simulation:",i))
# generating softcore process
data <- simulate_soft_core()
confidences <- thinning_sample_var(data, thinning_param, alpha, R=99, scaler = scaler)
for (j in 1:length(r)) {
if (confidences[j,1] <= K_actual[j] & K_actual[j] <= confidences[j,2]) {
coverage[j,2] <- coverage[j,2] + 1/nsim
}
}
}
return(coverage)
}
sc_thinning_sv_08_2 <- sc_simulation_thinning_sv_p_squared(100, 250, 0.8, 0.05)
sc_thinning_sv_05_2 <- sc_simulation_thinning_sv_p_squared(100, 250, 0.5, 0.05)
sc_thinning_sv_02_2 <- sc_simulation_thinning_sv_p_squared(100, 250, 0.2, 0.05)
ns_simulation_thinning_sv_p_squared <- function(nsim, lambda, thinning_param, alpha, R=99) {
r <- seq(0.0, 0.14, 0.01)
K_actual <- neyman_scott_actual_k()
cover <- rep(c(0),each=15)
coverage <- cbind(r, cover)
scaler <- 1/thinning_param^2
for (i in 1:nsim) {
print(paste0("Current simulation:",i))
# generating matÃ©rn cluster field
data <- rMatClust(25,0.1,10, win=owin(c(0,1),c(0,1)))
confidences <- thinning_sample_var(data, thinning_param, alpha, R=R, scaler = scaler)
print(confidences)
for (j in 1:length(r)) {
if (confidences[j,1] <= K_actual[j] & K_actual[j] <= confidences[j,2]) {
coverage[j,2] <- coverage[j,2] + 1/nsim
}
}
}
return(coverage)
}
ns_thinning_08_2 <- ns_simulation_thinning_sv_p_squared(100, 250, 0.8, 0.05)
ns_thinning_05_2 <- ns_simulation_thinning_sv_p_squared(100, 250, 0.5, 0.05)
ns_thinning_02_2 <- ns_simulation_thinning_sv_p_squared(100, 250, 0.2, 0.05)
par(mfrow=c(1,3))
par(mgp=c(2,1,0))
plot(thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(thinning_sv_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(thinning_sv_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
legend(0.01,0.2,c("p=0.8","p=0.5","p=0.2"),col=c(7,15,22),lwd=c(1.5,1.5,1.5),cex=1.3)
title("Homogenous Poisson",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(ns_thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
par(mgp=c(2,1,0))
plot(ns_thinning_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(ns_thinning_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(ns_thinning_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Neyman-Scott",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(sc_thinning_sv_08[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(sc_thinning_sv_05[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(sc_thinning_sv_02[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Soft Core",line=1,cex.main=1.5)
title("Studentized Cover for Ripley's K Using Analytic Scalar",line=-1.5,cex.main=1.5,outer=TRUE)
par(mfrow=c(1,3))
par(mgp=c(2,1,0))
plot(thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(thinning_sv_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(thinning_sv_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
legend(0.01,0.2,c("p=0.8","p=0.5","p=0.2"),col=c(7,15,22),lwd=c(1.5,1.5,1.5),cex=1.3)
title("Homogenous Poisson",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(ns_thinning_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(ns_thinning_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(ns_thinning_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Neyman-Scott",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(sc_thinning_sv_08[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(sc_thinning_sv_05[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
par(mgp=c(2,1,0))
plot(thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(thinning_sv_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(thinning_sv_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
legend(0.01,0.22,c("p=0.8","p=0.5","p=0.2"),col=c(7,15,22),lwd=c(1.5,1.5,1.5),cex=1.3)
title("Homogenous Poisson",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(ns_thinning_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(ns_thinning_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(ns_thinning_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Neyman-Scott",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(sc_thinning_sv_08[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(sc_thinning_sv_05[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(sc_thinning_sv_02[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Soft Core",line=1,cex.main=1.5)
title("Studentized Cover for Ripley's K Using Analytic Scalar",line=-1.5,cex.main=1.5,outer=TRUE)
par(mgp=c(2,1,0))
plot(thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(thinning_sv_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(thinning_sv_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
legend(0.01,0.25,c("p=0.8","p=0.5","p=0.2"),col=c(7,15,22),lwd=c(1.5,1.5,1.5),cex=1.3)
title("Homogenous Poisson",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(ns_thinning_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(ns_thinning_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(ns_thinning_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Neyman-Scott",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(sc_thinning_sv_08[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(sc_thinning_sv_05[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(sc_thinning_sv_02[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Soft Core",line=1,cex.main=1.5)
title("Studentized Cover for Ripley's K Using Analytic Scalar",line=-1.5,cex.main=1.5,outer=TRUE)
par(mfrow=c(1,3))
par(mgp=c(2,1,0))
plot(thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(thinning_sv_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(thinning_sv_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
legend(0.01,0.25,c("p=0.8","p=0.5","p=0.2"),col=c(7,15,22),lwd=c(1.5,1.5,1.5),cex=1.3)
title("Homogenous Poisson",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(ns_thinning_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(ns_thinning_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(ns_thinning_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Neyman-Scott",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(sc_thinning_sv_08[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(sc_thinning_sv_05[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(sc_thinning_sv_02[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Soft Core",line=1,cex.main=1.5)
title("Studentized Cover for Ripley's K Using Approximate Scalar",line=-1.5,cex.main=1.5,outer=TRUE)
par(mfrow=c(1,3))
par(mgp=c(2,1,0))
plot(thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(thinning_sv_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(thinning_sv_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
legend(0.01,0.25,c("p=0.8","p=0.5","p=0.2"),col=c(7,15,22),lwd=c(1.5,1.5,1.5),cex=1.3)
title("Homogenous Poisson",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(ns_thinning_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(ns_thinning_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(ns_thinning_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Neyman-Scott",line=1,cex.main=1.5)
par(mgp=c(2,1,0))
plot(sc_thinning_sv_08_2[-1,], type="l", lty=1, ylim=c(0,1), col=7, lwd=1.5, xlab="Radius, h", ylab="Confidence Interval Cover",cex.lab=1.2)
lines(sc_thinning_sv_05_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=15, lwd=1.5)
lines(sc_thinning_sv_02_2[-1,], type="l", lty=1, ylim=c(0.5,1), col=22, lwd=1.5)
abline(h=0.95, col=18, lwd=1.5, lty=2)
title("Soft Core",line=1,cex.main=1.5)
title("Studentized Cover for Ripley's K Using Approximate Scalar",line=-1.5,cex.main=1.5,outer=TRUE)
